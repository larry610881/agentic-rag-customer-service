# Agentic RAG Customer Service â€” é–‹ç™¼è¦ç¯„

## å°ˆæ¡ˆæ¦‚è¿°

Monorepo æ¶æ§‹çš„ RAG AI Agent é›»å•†å®¢æœå¹³å°ã€‚æ¡ç”¨ DDDï¼ˆDomain-Driven Designï¼‰+ TDD + BDD é–‹ç™¼æ–¹æ³•è«–ï¼Œå¾Œç«¯ Python FastAPI + LangGraphï¼Œå‰ç«¯ Next.js App Routerã€‚

## Monorepo çµæ§‹

```
agentic-rag-customer-service/
â”œâ”€â”€ apps/
â”‚   â”œâ”€â”€ backend/                # Python FastAPI â€” DDD 4-Layer
â”‚   â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”‚   â”œâ”€â”€ domain/         # é ˜åŸŸå±¤ï¼šEntity, Value Object, Repository Interface
â”‚   â”‚   â”‚   â”œâ”€â”€ application/    # æ‡‰ç”¨å±¤ï¼šUse Case, Command/Query Handler
â”‚   â”‚   â”‚   â”œâ”€â”€ infrastructure/ # åŸºç¤è¨­æ–½å±¤ï¼šDB, Qdrant, LangGraph, External API
â”‚   â”‚   â”‚   â””â”€â”€ interfaces/     # ä»‹é¢å±¤ï¼šFastAPI Router, CLI, Event Handler
â”‚   â”‚   â”œâ”€â”€ tests/
â”‚   â”‚   â””â”€â”€ pyproject.toml
â”‚   â””â”€â”€ frontend/               # Next.js 15 App Router
â”‚       â”œâ”€â”€ src/
â”‚       â”‚   â”œâ”€â”€ app/            # App Router pages
â”‚       â”‚   â”œâ”€â”€ components/     # å…±ç”¨å…ƒä»¶
â”‚       â”‚   â”œâ”€â”€ features/       # åŠŸèƒ½æ¨¡çµ„
â”‚       â”‚   â”œâ”€â”€ hooks/          # å…±ç”¨ hooks
â”‚       â”‚   â”œâ”€â”€ lib/            # å·¥å…·å‡½å¼
â”‚       â”‚   â”œâ”€â”€ stores/         # Zustand stores
â”‚       â”‚   â””â”€â”€ test/           # æ¸¬è©¦åŸºç¤è¨­æ–½
â”‚       â”œâ”€â”€ e2e/                # E2E BDD (Playwright)
â”‚       â””â”€â”€ package.json
â”œâ”€â”€ packages/                   # å…±ç”¨å¥—ä»¶ï¼ˆæœªä¾†æ“´å……ï¼‰
â”œâ”€â”€ infra/                      # Docker / K8s éƒ¨ç½²è¨­å®š
â”œâ”€â”€ data/                       # ç¨®å­è³‡æ–™ã€æ¸¬è©¦æ–‡ä»¶
â”œâ”€â”€ Makefile                    # çµ±ä¸€å…¥å£æŒ‡ä»¤
â””â”€â”€ CLAUDE.md                   # æœ¬æª”æ¡ˆ
```

## DDD æ¶æ§‹ç´…ç·šï¼ˆé•åå³ä¿®æ­£ï¼‰

1. **Domain å±¤ç¦æ­¢ä¾è³´å¤–å±¤** â€” `domain/` ä¸å¯ import `application/`ã€`infrastructure/`ã€`interfaces/`
2. **Application å±¤ç¦æ­¢ç›´æ¥å­˜å– DB** â€” Use Case é€é Repository Interface æ“ä½œï¼Œä¸å¯ import SQLAlchemy / Qdrant client
3. **Infrastructure å±¤å¯¦ä½œ Domain å®šç¾©çš„ä»‹é¢** â€” Repository Implementationã€External Service Adapter æ”¾é€™è£¡
4. **Interfaces å±¤ç¦æ­¢åŒ…å«æ¥­å‹™é‚è¼¯** â€” FastAPI Router åªè² è²¬ HTTP è½‰æ›ï¼Œå§”æ´¾çµ¦ Application å±¤
5. **ç¦æ­¢è·¨èšåˆæ ¹ç›´æ¥æ“ä½œ** â€” èšåˆä¹‹é–“é€é Domain Event æˆ– Application Service å”èª¿
6. **ç¦æ­¢ hardcode æ©Ÿå¯†èˆ‡ç’°å¢ƒåƒæ•¸** â€” å¯†é‘°ã€é€£ç·šã€timeout ç­‰å¿…é ˆé€é config + `.env` ç®¡ç†

### ä¾è³´æ–¹å‘åœ–ï¼ˆåªå…è¨±å‘ä¸‹ä¾è³´ï¼‰

```
Interfaces (interfaces/)
    â†“
Application (application/)
    â†“
Domain (domain/)    â† Infrastructure (infrastructure/) å¯¦ä½œ Domain ä»‹é¢
```

## é™ç•Œä¸Šä¸‹æ–‡ï¼ˆBounded Contextsï¼‰

| ä¸Šä¸‹æ–‡ | è·¯å¾‘ | è·è²¬ |
|--------|------|------|
| Tenant | `domain/tenant/` | å¤šç§Ÿæˆ¶ç®¡ç†ã€ç§Ÿæˆ¶éš”é›¢ |
| Knowledge | `domain/knowledge/` | çŸ¥è­˜åº«ç®¡ç†ã€æ–‡ä»¶ä¸Šå‚³èˆ‡åˆ†å¡Š |
| RAG | `domain/rag/` | æª¢ç´¢å¢å¼·ç”Ÿæˆã€å‘é‡æœå°‹ã€Prompt çµ„è£ |
| Conversation | `domain/conversation/` | å°è©±ç®¡ç†ã€å°è©±æ­·å² |
| Agent | `domain/agent/` | LangGraph Agent ç·¨æ’ã€Tool ç®¡ç† |

## æŠ€è¡“æ£§

### å¾Œç«¯
| é¡åˆ¥ | æŠ€è¡“ |
|------|------|
| èªè¨€ | Python 3.12+ |
| Web æ¡†æ¶ | FastAPI |
| DI å®¹å™¨ | dependency-injector |
| AI ç·¨æ’ | LangGraph |
| å‘é‡è³‡æ–™åº« | Qdrant |
| Embedding | OpenAI / Azure OpenAI |
| LLM | Claude / GPT-4 |
| ORM | SQLAlchemy 2.0 (async) |
| æ¸¬è©¦ | pytest + pytest-bdd v8 |

### å‰ç«¯
| é¡åˆ¥ | æŠ€è¡“ |
|------|------|
| æ¡†æ¶ | Next.js 15 (App Router) |
| UI å…ƒä»¶åº« | shadcn/ui (Tailwind CSS + Radix UI) |
| Client State | Zustand |
| Server State | TanStack Query |
| è¡¨å–® | React Hook Form + Zod |
| Unit æ¸¬è©¦ | Vitest + React Testing Library |
| Integration æ¸¬è©¦ | Vitest + RTL + MSW |
| E2E æ¸¬è©¦ | Playwright + playwright-bdd |

## å¥—ä»¶ç®¡ç†

| ç¯„åœ | å·¥å…· | æŒ‡ä»¤ |
|------|------|------|
| å¾Œç«¯ | uv | `uv sync` / `uv add <pkg>` / `uv run <cmd>` |
| å‰ç«¯ | npm | `npm install` / `npm run <script>` |
| çµ±ä¸€å…¥å£ | make | `make <target>` |

## å¸¸ç”¨æŒ‡ä»¤

```bash
# é–‹ç™¼ç’°å¢ƒ
make dev-up                  # å•Ÿå‹•æ‰€æœ‰æœå‹™ï¼ˆDocker Composeï¼‰
make dev-down                # åœæ­¢æ‰€æœ‰æœå‹™

# å¾Œç«¯
make test-backend            # å¾Œç«¯å…¨é‡æ¸¬è©¦
make lint-backend            # å¾Œç«¯ lint (ruff + mypy)
make seed-data               # ç¨®å­è³‡æ–™

# å‰ç«¯
make test-frontend           # å‰ç«¯å…¨é‡æ¸¬è©¦
make lint-frontend           # å‰ç«¯ lint (ESLint + tsc)
make test-e2e                # E2E BDD æ¸¬è©¦

# å…¨éƒ¨
make test                    # å¾Œç«¯ + å‰ç«¯å…¨é‡æ¸¬è©¦
make lint                    # å¾Œç«¯ + å‰ç«¯ lint
```

## æ¸¬è©¦ç­–ç•¥

### æ¸¬è©¦é‡‘å­—å¡”ï¼ˆ60:30:10ï¼‰

```
        /  E2E  \          Playwright (å‰ç«¯) / pytest-bdd (å¾Œç«¯) â€” çœŸå¯¦æœå‹™
       /  Integ  \         MSW (å‰ç«¯) / httpx.AsyncClient (å¾Œç«¯) â€” çœŸå¯¦ DB
      /   Unit    \        Vitest (å‰ç«¯) / pytest (å¾Œç«¯) â€” å®Œå…¨éš”é›¢
```

- è¦†è“‹ç‡é–€æª»ï¼š**80%**
- **å¾Œç«¯**ï¼šBDD-firstï¼ˆå…ˆå¯« `.feature`ï¼Œå†å¯« step definitionsï¼‰
- **å‰ç«¯**ï¼šTDD + BDDï¼ˆUnit/Integration ç”¨ TDDï¼ŒE2E ç”¨ BDDï¼‰

### æ¸¬è©¦å®Œæ•´æ€§ç´…ç·šï¼ˆé•åå³ä¿®æ­£ï¼‰

1. **å…¨é‡æ¸¬è©¦å¿…é ˆé€šé** â€” æ¯æ¬¡åŠŸèƒ½å®Œæˆèˆ‡ commit å‰ï¼ŒåŸ·è¡Œ `make test`ï¼Œå…¨éƒ¨æ¸¬è©¦ï¼ˆéåƒ…æ–°å¢çš„ï¼‰å¿…é ˆ pass
2. **ç¦æ­¢ä¿®æ”¹ç„¡é—œæ¸¬è©¦** â€” ä¸å¾—ç‚ºäº†æ¶ˆé™¤å¤±æ•—è€Œä¿®æ”¹èˆ‡æœ¬æ¬¡éœ€æ±‚ç„¡é—œçš„æ¸¬è©¦ï¼ˆåˆªé™¤ assertã€æ”¾å¯¬æ¢ä»¶ã€skip æ¸¬è©¦çš†å±¬é•è¦ï¼‰
3. **å¤±æ•—æ­¸å› åŸå‰‡** â€” æ—¢æœ‰æ¸¬è©¦å¤±æ•— = ä½ çš„ç¨‹å¼ç¢¼æœ‰å›æ­¸ï¼Œæ‡‰ä¿®æ­£å¯¦ä½œè€Œéä¿®æ”¹æ¸¬è©¦
4. **åˆæ³•ä¿®æ”¹æ¸¬è©¦çš„å”¯ä¸€æ¢ä»¶** â€” éœ€æ±‚æ˜ç¢ºè¦æ±‚æ”¹è®Šè¡Œç‚ºï¼Œå°æ‡‰æ¸¬è©¦çš„æ–·è¨€å¿…é ˆåŒæ­¥æ›´æ–°
5. **ä¸ç¢ºå®šæ™‚å…ˆå ±å‘Š** â€” è‹¥æ—¢æœ‰æ¸¬è©¦å¤±æ•—ä¸”åˆ¤æ–·éæœ¬æ¬¡è®Šæ›´å¼•èµ·ï¼Œå‘ä½¿ç”¨è€…å ±å‘Šä¸¦ç­‰å¾…ç¢ºèª

### å¾Œç«¯æ¸¬è©¦å±¤ç´šå°ç…§

| å±¤ç´š | ä½ç½® | å·¥å…· | DB | Repository |
|------|------|------|-----|-----------|
| Unit | `tests/unit/` | pytest-bdd + AsyncMock | âŒ Mock | âŒ AsyncMock |
| Integration | `tests/integration/` | pytest-bdd + httpx | âœ… çœŸå¯¦ | âœ… çœŸå¯¦ |
| E2E | `tests/e2e/` | pytest-bdd | âœ… çœŸå¯¦ | âœ… çœŸå¯¦ |

### å‰ç«¯æ¸¬è©¦å±¤ç´šå°ç…§

| å±¤ç´š | ä½ç½® | å·¥å…· | API |
|------|------|------|-----|
| Unit | `*.test.tsx` | Vitest + RTL | vi.mock |
| Integration | `*.integration.test.tsx` | Vitest + RTL + MSW | MSW Handler |
| E2E | `e2e/features/` | playwright-bdd | çœŸå¯¦ API |

## Agent Team åˆ†å·¥

| Agent | Lead | Backend | AI/RAG | Frontend | E2E æ•´åˆ |
|-------|:----:|:-------:|:------:|:--------:|:--------:|
| planner | âœ“ | | | | âœ“ (å”èª¿) |
| ddd-checker | âœ“ | âœ“ | âœ“ | | |
| security-reviewer | âœ“ | âœ“ | | âœ“ | |
| test-runner-backend | | âœ“ | âœ“ | | |
| test-runner-frontend | | | | âœ“ | |
| e2e-integration-tester | | | | | âœ“ |
| implementation-guide | | âœ“ | âœ“ | | |
| build-error-resolver | | âœ“ | âœ“ | âœ“ | |
| code-reviewer | | | | âœ“ | |
| rag-pipeline-checker | | | âœ“ | | |
| ui-designer | | | | âœ“ | |

### E2E æ•´åˆæ¸¬è©¦å”èª¿è¦å‰‡

æ¶‰åŠå‰å¾Œç«¯çš„åŠŸèƒ½ï¼ŒLeadï¼ˆplannerï¼‰å¿…é ˆå»ºç«‹ **3 å±¤ Task çµæ§‹**ï¼š

```
Task: å¾Œç«¯å¯¦ä½œ  â”€â”€â”
                   â”œâ”€â”€â†’ Task: E2E æ•´åˆæ¸¬è©¦ (addBlockedBy: å‰å…©è€…)
Task: å‰ç«¯å¯¦ä½œ  â”€â”€â”˜      owner: e2e-integration-tester
```

- E2E é€šé â†’ åŠŸèƒ½å®Œæˆ
- E2E å¤±æ•— â†’ Lead åˆ†ææ ¹å›  â†’ å»ºç«‹ä¿®å¾© Task â†’ é‡è·‘ E2E

### Subagent ä½¿ç”¨ç­–ç•¥

- **ä¿è­·ä¸» context window** â€” ç ”ç©¶ã€æ¢ç´¢ã€å¹³è¡Œåˆ†æç­‰è³‡è¨Šå¯†é›†å‹å·¥ä½œå„ªå…ˆå§”æ´¾çµ¦ subagent
- **ä¸€ agent ä¸€ä»»å‹™** â€” æ¯å€‹ subagent èšç„¦å–®ä¸€æ˜ç¢ºç›®æ¨™ï¼Œé¿å…æ··åˆè·è²¬
- **å¹³è¡ŒåŒ–ç¨ç«‹å·¥ä½œ** â€” å‰å¾Œç«¯ç„¡ä¾è³´çš„ä»»å‹™åŒæ™‚åˆ†æ´¾å¤šå€‹ subagent åŸ·è¡Œ
- **é¿å…é‡è¤‡å‹å‹•** â€” å·²å§”æ´¾çµ¦ subagent çš„èª¿æŸ¥ï¼Œä¸» agent ä¸å†é‡è¤‡æœå°‹åŒä¸€å…§å®¹

### Subagent vs Agent Teams é¸æ“‡åŸºæº–

| æ¢ä»¶ | é¸æ“‡ | ç¯„ä¾‹ |
|------|------|------|
| ä»»å‹™äº’ç›¸ç¨ç«‹ã€ä¸éœ€ä¸­é–“æºé€š | **Subagent** | ddd-checker + security-reviewer å¹³è¡Œæƒæ |
| å¤šå€‹ç¨ç«‹çµæœéœ€è¦å½™æ•´ | **Subagent** + ä¸» agent å½™æ•´ | ä¸‰å€‹ agent å„åˆ†æä¸€å€‹æ¨¡çµ„ï¼Œä¸» agent åˆä½µçµè«– |
| ä»»å‹™ä¹‹é–“æœ‰ blocking ä¾è³´ | **Agent Teams** | å¾Œç«¯å®Œæˆ â†’ å‰ç«¯å®Œæˆ â†’ E2E æ‰èƒ½è·‘ |
| éœ€è¦ agent ä¹‹é–“å³æ™‚æºé€šèª¿æ•´ | **Agent Teams** | å¾Œç«¯æ”¹ API schema â†’ é€šçŸ¥å‰ç«¯åŒæ­¥ä¿®æ”¹ |

**åˆ¤æ–·å£è¨£ï¼šèƒ½ fire-and-forget å°±ç”¨ Subagentï¼Œéœ€è¦ç­‰å¾…æˆ–å°è©±å°±ç”¨ Teamsã€‚**

## é–‹ç™¼å·¥ä½œæµï¼ˆå…­éšæ®µï¼Œä¸å¯è·³éï¼‰

### Stage 0ï¼šIssue å»ºç«‹
- è¨ˆç•«ç¢ºèªå¾Œï¼Œä½¿ç”¨ `gh issue create` å»ºç«‹ GitHub Issue
- Issue å…§å®¹ï¼šSummary + Sub-tasksï¼ˆcheckboxï¼‰ + Acceptance Criteria
- Issue labelï¼š`enhancement`ï¼ˆåŠŸèƒ½ï¼‰/ `bug`ï¼ˆä¿®å¾©ï¼‰/ `refactor`ï¼ˆé‡æ§‹ï¼‰
- å¾ŒçºŒ commit message åŠ ä¸Š `Refs #<issue-number>`

### Stage 1ï¼šè¨­è¨ˆèˆ‡æ¶æ§‹
- ç¢ºèªé™ç•Œä¸Šä¸‹æ–‡æ­¸å±¬
- è¦åŠƒ DDD 4 å±¤çš„æª”æ¡ˆè½é»ï¼ˆDomain â†’ Application â†’ Infrastructure â†’ Interfacesï¼‰
- è‹¥æ¶‰åŠ RAGï¼Œè¦åŠƒ LangGraph ç¯€é»èˆ‡ Tool
- é‡å¤§æ±ºç­–è¨˜éŒ„ ADR

### Stage 2ï¼šBDD è¡Œç‚ºè¦æ ¼
- **å…ˆå¯« `.feature` å†å¯«ä»»ä½•ç¨‹å¼ç¢¼**
- Gherkin é—œéµå­—ç¶­æŒè‹±æ–‡ï¼Œæè¿°å…§å®¹ä½¿ç”¨ç¹é«”ä¸­æ–‡
- å¾Œç«¯ï¼š`apps/backend/tests/features/`
- å‰ç«¯ E2Eï¼š`apps/frontend/e2e/features/`

### Stage 3ï¼šTDD æ¸¬è©¦
- æ ¹æ“š `.feature` æ’°å¯«æœƒå¤±æ•—çš„æ¸¬è©¦ï¼ˆç´…ç‡ˆï¼‰
- **ç¦æ­¢åœ¨æ²’æœ‰å°æ‡‰æ¸¬è©¦çš„æƒ…æ³ä¸‹é–‹å§‹å¯¦ä½œåŠŸèƒ½ä»£ç¢¼**
- å¾Œç«¯ Unit Test å¿…é ˆç”¨ `AsyncMock` mock Repositoryï¼Œç¦æ­¢çœŸå¯¦ DB
- å‰ç«¯ Unit Test å¿…é ˆç”¨ `vi.mock()` éš”é›¢ä¾è³´

### Stage 4ï¼šè¦ç¯„åŒ–å¯¦ä½œ
- **å¾Œç«¯** DDD 4-Layer é †åºï¼šDomain Entity â†’ Application Use Case â†’ Infrastructure Impl â†’ Interfaces Router
- **å‰ç«¯** å…ƒä»¶é–‹ç™¼é †åºï¼šType â†’ Hook â†’ Component â†’ Page
- **å“è³ªåæ€ï¼ˆé trivial è®Šæ›´ï¼‰**ï¼šå¯¦ä½œå®Œæˆå¾Œè‡ªå•ã€Œæ˜¯å¦æœ‰æ›´å„ªé›…çš„è§£æ³•ï¼Ÿã€ï¼Œè‹¥æœ‰å‰‡é‡æ§‹ï¼›ç°¡å–®æ˜ç¢ºçš„ä¿®æ”¹ä¸éœ€é¡å¤–åæ€

### Stage 5ï¼šé©—è­‰èˆ‡äº¤ä»˜
- å…¨é‡æ¸¬è©¦é€šéï¼š`make test`
- ç„¡ lint éŒ¯èª¤ï¼š`make lint`
- è¦†è“‹ç‡ â‰¥ 80%
- å·² commit ä¸¦ push
- **Close Issue**ï¼š`gh issue close <number> --reason completed`

## Bug Fix å·¥ä½œæµï¼ˆä¸å¯çœç•¥æ¸¬è©¦ï¼‰

1. **é‡ç¾**ï¼šç¢ºèª Bug çš„è§¸ç™¼æ¢ä»¶èˆ‡é æœŸè¡Œç‚º
2. **å¯« Regression Test**ï¼šå…ˆå¯«ä¸€å€‹æœƒ FAIL çš„æ¸¬è©¦é‡ç¾ Bug
3. **ä¿®å¾©**ï¼šä¿®æ”¹ç¨‹å¼ç¢¼ç›´åˆ° regression test é€šé
4. **é©—è­‰**ï¼šå…¨é‡æ¸¬è©¦é€šé + è¦†è“‹ç‡ä¸ä¸‹é™

> **åŸå‰‡ï¼šæ¯å€‹ Bug fix éƒ½å¿…é ˆç•™ä¸‹ regression testã€‚**
> **Root Cause åŸå‰‡ï¼šå¿…é ˆæ‰¾åˆ°æ ¹å› å†ä¿®å¾©ï¼Œç¦æ­¢è‡¨æ™‚ç¹éæˆ–è¡¨é¢ä¿®è£œã€‚è‹¥ä¿®å¾©æ–¹å¼æ„Ÿè¦º hackyï¼Œé€€ä¸€æ­¥é‡æ–°åˆ†æå•é¡Œæœ¬è³ªã€‚**

## Sprint ç®¡ç†

- **é–‹ç™¼è¨ˆç•«**ï¼š`DEVELOPMENT_PLAN.md` â€” å®Œæ•´çš„ S0-S7 Sprint è¦åŠƒ
- **é€²åº¦è¿½è¹¤**ï¼š`SPRINT_TODOLIST.md` â€” æ‰€æœ‰ Sprint ä»»å‹™çš„ checkbox è¿½è¹¤
- **åˆè¦æª¢æŸ¥**ï¼š`/sprint-sync` â€” æƒæè¦ç¯„åˆè¦ + åŒæ­¥æ›´æ–° todolist

### Todolist åŒæ­¥è¦å‰‡

ä»¥ä¸‹æƒ…å¢ƒ**å¿…é ˆ**åŒæ­¥æ›´æ–° `SPRINT_TODOLIST.md`ï¼š
1. **ä»»å‹™å®Œæˆæ™‚** â€” å°‡å°æ‡‰é …ç›®æ¨™è¨˜ç‚º âœ…
2. **è¨ˆç•«è®Šæ›´æ™‚** â€” æ–°å¢/ç§»é™¤/ä¿®æ”¹ todolist é …ç›®
3. **é–‹ç™¼é©—è­‰æ™‚** â€” åŸ·è¡Œ `/sprint-sync` è‡ªå‹•æƒæä¸¦æ›´æ–°
4. **Session çµæŸå‰** â€” Stop hook æœƒæé†’æª¢æŸ¥ todolist æ˜¯å¦å·²åŒæ­¥

### Issue é€²åº¦åŒæ­¥è¦å‰‡

1. **è¨ˆç•«å®Œæˆå¾Œ** â€” å»ºç«‹ GitHub Issueï¼ˆSub-tasks ç”¨ checkboxï¼‰
2. **æ¯å€‹å­ä»»å‹™å®Œæˆå¾Œ** â€” åœ¨ Issue ç•™ comment æ›´æ–°é€²åº¦ï¼ˆå¦‚ `E1.3 å®Œæˆï¼š6 Use Cases`ï¼‰
3. **å…¨éƒ¨å®Œæˆå¾Œ** â€” Close Issue + æ›´æ–° SPRINT_TODOLIST.md

## å®‰å…¨æ³¨æ„äº‹é …

- **hardcode ç¦æ­¢**ï¼šå¯†é‘°ã€API keyã€connection string å¿…é ˆé€é `.env` ç®¡ç†
- **.env ç®¡ç†**ï¼šæ‰€æœ‰ `.env` æª”æ¡ˆå·²åŠ å…¥ `.gitignore`ï¼Œç¦æ­¢æäº¤è‡³ç‰ˆæ§
- **Prompt Injection é˜²è­·**ï¼šä½¿ç”¨è€…è¼¸å…¥ä¸å¾—ç›´æ¥æ‹¼å…¥ System Promptï¼Œå¿…é ˆé€é RAG Pipeline çš„ sanitize å±¤è™•ç†
- **ç§Ÿæˆ¶éš”é›¢**ï¼šæ‰€æœ‰å‘é‡æœå°‹èˆ‡çŸ¥è­˜åº«æ“ä½œå¿…é ˆåŒ…å« `tenant_id` éæ¿¾æ¢ä»¶
- **å‰ç«¯å®‰å…¨**ï¼šç¦æ­¢ `dangerouslySetInnerHTML`ï¼Œç’°å¢ƒè®Šæ•¸ä½¿ç”¨ `NEXT_PUBLIC_` å‰ç¶´
- **CORS**ï¼šæ­£å¼ç’°å¢ƒç¦æ­¢ `allow_origins=["*"]`

---

## ä»»å‹™å®Œæˆå¾Œï¼šæ¶æ§‹å­¸ç¿’èˆ‡éš±æ†‚åˆ†æï¼ˆLearning Reviewï¼‰

> **ç›®çš„**ï¼šæ¯æ¬¡ä»»å‹™å®Œæˆå¾Œï¼Œä¸»å‹•é€²è¡ŒæŠ€è¡“æ·±åº¦åˆ†æï¼Œå¹«åŠ©é–‹ç™¼è€…æŒçºŒæå‡æ¶æ§‹èˆ‡è¨­è¨ˆèƒ½åŠ›ã€‚
> **ç§»é™¤æç¤º**ï¼šæ­¤æ®µç‚ºå­¸ç¿’è¼”åŠ©ç”¨é€”ï¼Œè‹¥ token æ¶ˆè€—éé«˜å¯æ•´æ®µåˆªé™¤ï¼Œä¸å½±éŸ¿é–‹ç™¼æµç¨‹ã€‚

### è§¸ç™¼æ™‚æ©Ÿ

æ¯ç•¶ä¸€å€‹**é trivial ä»»å‹™å®Œæˆ**ï¼ˆåŠŸèƒ½é–‹ç™¼ã€Bug ä¿®å¾©ã€é‡æ§‹ï¼‰å¾Œï¼Œåœ¨äº¤ä»˜çµæœçš„åŒæ™‚é™„ä¸Šä¸€æ®µ **ã€Œæ¶æ§‹å­¸ç¿’ç­†è¨˜ã€**ã€‚

### é Trivial ä»»å‹™åˆ¤å®šåŸºæº–

æ»¿è¶³**ä»»ä¸€æ¢ä»¶**å³ç‚ºé trivialï¼Œéœ€ç”¢å‡ºå­¸ç¿’ç­†è¨˜ï¼š

| ç¶­åº¦ | Trivialï¼ˆä¸éœ€ç­†è¨˜ï¼‰ | Non-Trivialï¼ˆéœ€è¦ç­†è¨˜ï¼‰ |
|------|---------------------|------------------------|
| æª”æ¡ˆæ•¸ | 1-3 å€‹æª”æ¡ˆ | 4+ å€‹æª”æ¡ˆ |
| DDD å±¤æ•¸ | å–®å±¤è®Šæ›´ | è·¨ 2+ å±¤ï¼ˆå¦‚ Domain + Infrastructureï¼‰ |
| è¨­è¨ˆæ¨¡å¼ | ç„¡æ–°æ¨¡å¼å¼•å…¥ | ç”¨äº†æ–°çš„ Pattern |
| æ¸¬è©¦ | ç„¡æ–° scenario | æ–°å¢ BDD scenario |
| å‰å¾Œç«¯ | å–®ç«¯è®Šæ›´ | å‰å¾Œç«¯éƒ½å‹• |

> **å£è¨£ï¼šè·¨å±¤æˆ–è·¨ç«¯ï¼Œå°±è¦å¯«ç­†è¨˜ã€‚**

### ç­†è¨˜æŒä¹…åŒ–

- æ‰€æœ‰å­¸ç¿’ç­†è¨˜**å¿…é ˆè¿½åŠ **è‡³ `docs/architecture-journal.md`
- æ ¼å¼ï¼šæ¯å‰‡ç­†è¨˜åŒ…å«ã€ŒSprint ä¾†æº â†’ ä¸»é¡Œ â†’ åšå¾—å¥½ â†’ æ½›åœ¨éš±æ†‚ â†’ å»¶ä¼¸å­¸ç¿’ã€
- æ–°ç­†è¨˜æ’å…¥åœ¨ç›®éŒ„ä¸‹æ–¹ã€æ—¢æœ‰ç­†è¨˜ä¸Šæ–¹ï¼ˆæœ€æ–°åœ¨æœ€å‰ï¼‰
- åŒæ­¥æ›´æ–°ç›®éŒ„ï¼ˆTable of Contentsï¼‰å€å¡Š

### åˆ†æç¶­åº¦ï¼ˆä¾ç›¸é—œæ€§æŒ‘é¸ï¼Œä¸å¿…æ¯æ¬¡å…¨éƒ¨è¦†è“‹ï¼‰

| ç¶­åº¦ | åˆ†æå…§å®¹ |
|------|----------|
| **Design Patterns** | æœ¬æ¬¡å¯¦ä½œç”¨äº†å“ªäº›æ¨¡å¼ï¼Ÿæ˜¯å¦æœ‰æ›´åˆé©çš„æ›¿ä»£æ¨¡å¼ï¼Ÿå¸¸è¦‹èª¤ç”¨è­¦ç¤º |
| **DDD æˆ°è¡“è¨­è¨ˆ** | Aggregate é‚Šç•Œæ˜¯å¦åˆç†ï¼ŸDomain Event æ˜¯å¦è©²å¼•å…¥ï¼ŸValue Object vs Entity åˆ¤æ–· |
| **System Design** | è‹¥æ­¤åŠŸèƒ½è¦æ”¯æ’ 10x/100x æµé‡ï¼Œæ¶æ§‹ç“¶é ¸åœ¨å“ªï¼Ÿéœ€è¦å“ªäº›æ”¹å‹•ï¼Ÿ |
| **å¾®æœå‹™ / åˆ†æ•£å¼** | ç•¶å‰ monolith çš„å“ªäº›éƒ¨åˆ†æœªä¾†æ‹†åˆ†æ™‚æœƒç—›ï¼ŸCAP å–æ¨ã€è³‡æ–™ä¸€è‡´æ€§é¢¨éšª |
| **é«˜ä½µç™¼å ´æ™¯** | Race conditionã€å†ªç­‰æ€§ã€æ¨‚è§€é– / æ‚²è§€é–ã€Queue-based è§£è€¦æ˜¯å¦éœ€è¦ï¼Ÿ |
| **Design System / UI** | å…ƒä»¶æŠ½è±¡å±¤ç´šã€Token é«”ç³»ä¸€è‡´æ€§ã€Accessibility ç¼ºå£ã€éŸ¿æ‡‰å¼æ–·é»ç­–ç•¥ |
| **å¯è§€æ¸¬æ€§** | Logging / Tracing / Metrics æ˜¯å¦è¶³å¤ ï¼Ÿå‘Šè­¦è©²è¨­åœ¨å“ªï¼Ÿ |
| **å®‰å…¨éš±æ†‚** | æœ¬æ¬¡è®Šæ›´æ˜¯å¦å¼•å…¥æ–°çš„æ”»æ“Šé¢ï¼ŸOWASP Top 10 å°ç…§æª¢æŸ¥ |

### è¼¸å‡ºæ ¼å¼

```markdown
### ğŸ“ æ¶æ§‹å­¸ç¿’ç­†è¨˜

**æœ¬æ¬¡ç›¸é—œä¸»é¡Œ**ï¼š[ä¾‹ï¼šRepository Patternã€CQRSã€ç§Ÿæˆ¶éš”é›¢]

#### åšå¾—å¥½çš„åœ°æ–¹
- ...

#### æ½›åœ¨éš±æ†‚
- [éš±æ†‚æè¿°] â†’ [å»ºè­°æ”¹å–„æ–¹å‘] â†’ [å„ªå…ˆç´šï¼šä½/ä¸­/é«˜]

#### å»¶ä¼¸å­¸ç¿’
- [æ¦‚å¿µåç¨±]ï¼š[ä¸€å¥è©±è§£é‡‹ç‚ºä»€éº¼è·Ÿæœ¬æ¬¡ä»»å‹™ç›¸é—œ]
- è‹¥æƒ³æ·±å…¥ï¼š[æ¨è–¦æœå°‹é—œéµå­—æˆ–ç¶“å…¸åƒè€ƒè³‡æ–™åç¨±]

#### å¦‚æœæ²’æœ‰æ˜é¡¯éš±æ†‚
ä¸»å‹•æŒ‘ä¸€å€‹èˆ‡æœ¬æ¬¡ä»»å‹™æœ€ç›¸é—œçš„é€²éšä¸»é¡Œé€²è¡Œç°¡çŸ­æ•™å­¸ï¼ˆ3-5 æ®µï¼‰ï¼Œä¸¦æå‡ºä¸€å€‹æ€è€ƒé¡Œèˆ‡é–‹ç™¼è€…è¨è«–ã€‚
```

### æ·±åº¦ç­‰ç´šï¼ˆä¾ä»»å‹™è¤‡é›œåº¦èª¿æ•´ï¼‰

| ä»»å‹™è¦æ¨¡ | å­¸ç¿’ç­†è¨˜æ·±åº¦ |
|----------|-------------|
| å°å‹ä¿®å¾© / å–®æª”è®Šæ›´ | 1-2 å¥æç¤ºï¼Œæˆ–æ¨™è¨»ã€Œç„¡ç‰¹åˆ¥éš±æ†‚ã€ |
| ä¸­å‹åŠŸèƒ½ / è·¨å±¤è®Šæ›´ | æŒ‘ 2-3 å€‹ç¶­åº¦åˆ†æï¼Œé™„å»¶ä¼¸å­¸ç¿’ |
| å¤§å‹åŠŸèƒ½ / æ¶æ§‹è®Šæ›´ | å®Œæ•´åˆ†æ + è¨è«–é¡Œ + æ›¿ä»£æ–¹æ¡ˆæ¯”è¼ƒ |
