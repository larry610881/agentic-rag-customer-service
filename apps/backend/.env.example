# ==============================
# Agentic RAG Customer Service
# Backend Environment Variables
# ==============================

# --- Database (PostgreSQL) ---
POSTGRES_USER=postgres
POSTGRES_PASSWORD=postgres
POSTGRES_HOST=localhost
POSTGRES_PORT=5432
POSTGRES_DB=agentic_rag

# --- Redis ---
REDIS_HOST=localhost
REDIS_PORT=6379

# --- Qdrant ---
QDRANT_HOST=localhost
QDRANT_REST_PORT=6333
QDRANT_GRPC_PORT=6334

# --- JWT ---
JWT_SECRET_KEY=dev-secret-key-change-in-production
JWT_ALGORITHM=HS256
JWT_ACCESS_TOKEN_EXPIRE_MINUTES=60

# ==============================
# Shared Provider API Keys (fallback)
# Used when EMBEDDING_API_KEY / LLM_API_KEY are not set
# ==============================

# OpenAI
OPENAI_API_KEY=sk-xxx

# Anthropic
ANTHROPIC_API_KEY=sk-ant-xxx

# Qwen (阿里雲百煉 DashScope) — 新用戶免費 token
QWEN_API_KEY=sk-xxx

# OpenRouter — multi-model gateway
OPENROUTER_API_KEY=sk-or-xxx

# ==============================
# Embedding Configuration (獨立於 LLM)
# ==============================

# Provider: fake | openai | qwen
EMBEDDING_PROVIDER=fake
# Dedicated API key (optional; falls back to QWEN_API_KEY / OPENAI_API_KEY)
# EMBEDDING_API_KEY=sk-xxx
EMBEDDING_MODEL=text-embedding-v3
EMBEDDING_VECTOR_SIZE=1024
# Override base URL (optional, auto-detected from provider)
# EMBEDDING_BASE_URL=https://dashscope.aliyuncs.com/compatible-mode/v1

# --- 百煉 Embedding 模型排序（差→好） ---
# 1. text-embedding-v3      — 基礎文字向量，1024 維，穩定可靠，先用這個測試
# 2. text-embedding-v4      — 最新文字向量，支援 instruct + sparse vectors，生產環境升級用
# 3. tongyi-embedding-vision-flash — 多模態（圖文）輕量版，需要圖片理解時使用
# 4. tongyi-embedding-vision-plus  — 多模態（圖文）完整版，圖文混合搜尋最強
# *  qwen3-rerank           — 重排序模型（非 embedding），用於搜尋結果二次排序
#
# 新用戶免費額度：每個模型各 1,000,000 tokens，有效期至開通後 90 天

# ==============================
# LLM Configuration (獨立於 Embedding)
# ==============================

# Provider: fake | openai | anthropic | qwen | openrouter
LLM_PROVIDER=fake
# Dedicated API key (optional; falls back to QWEN_API_KEY / OPENAI_API_KEY / etc.)
# LLM_API_KEY=sk-xxx
# Model name (defaults per provider: openai=gpt-4o, anthropic=claude-sonnet-4-20250514, qwen=qwen-plus, openrouter=openai/gpt-4o)
LLM_MODEL=
LLM_MAX_TOKENS=1024
# Override base URL (optional, auto-detected from provider)
# LLM_BASE_URL=https://dashscope.aliyuncs.com/compatible-mode/v1

# --- 百煉 LLM 模型排序（便宜→貴，由弱到強） ---
#
# 文字對話模型：
# 1. qwen2.5-7b-instruct-1m  — 7B 小模型，支援 1M context，速度最快，適合簡單問答先測試
# 2. qwen-plus-2025-07-28    — 中階模型，性價比最高，日常客服推薦用這個
# 3. qwen3.5-122b-a10b       — 122B MoE（10B 活躍），能力接近 Max 但更省 token
# 4. qwen3-max               — 旗艦級，萬億參數，最強推理能力，費用最高
#
# 視覺模型（支援圖片輸入）：
# *  qwen-vl-plus-2025-05-07      — 視覺對話輕量版
# *  qwen2.5-vl-72b-instruct      — 72B 視覺模型
# *  qwen-vl-max-2025-04-08       — 視覺旗艦
# *  qwen3-vl-235b-a22b-thinking  — 235B 視覺+思考鏈，最強
#
# 推理/特殊模型：
# *  qvq-max-2025-03-25      — 視覺推理模型（數學/程式/分析）
# *  qwen-vl-ocr-2025-11-20  — OCR 專用（圖片文字辨識）
#
# 新用戶免費額度：每個模型各 1,000,000 tokens，有效期至開通後 90 天
# 建議：先用 qwen-plus 測試，確認流程通了再考慮升級

# --- Quick-Start: Qwen 全套 (同一把 key) ---
#
#   QWEN_API_KEY=sk-xxx
#   EMBEDDING_PROVIDER=qwen
#   EMBEDDING_MODEL=text-embedding-v3
#   EMBEDDING_VECTOR_SIZE=1024
#   LLM_PROVIDER=qwen
#   LLM_MODEL=qwen-plus
#
# --- Quick-Start: Embedding 和 LLM 分開 ---
#
#   EMBEDDING_PROVIDER=qwen
#   EMBEDDING_API_KEY=sk-embed-xxx
#   EMBEDDING_MODEL=text-embedding-v3
#   LLM_PROVIDER=openai
#   LLM_API_KEY=sk-llm-xxx
#   LLM_MODEL=gpt-4o

# ==============================
# RAG Configuration
# ==============================

RAG_SCORE_THRESHOLD=0.3
RAG_TOP_K=5

# ==============================
# LINE Bot
# ==============================

LINE_CHANNEL_SECRET=
LINE_CHANNEL_ACCESS_TOKEN=
LINE_DEFAULT_TENANT_ID=
LINE_DEFAULT_KB_ID=

# ==============================
# LLM Pricing (JSON)
# ==============================

# Format: {"model_name": {"input": price_per_1m_tokens, "output": price_per_1m_tokens}}
LLM_PRICING_JSON={}

# ==============================
# App
# ==============================

APP_ENV=development
APP_VERSION=0.1.0
